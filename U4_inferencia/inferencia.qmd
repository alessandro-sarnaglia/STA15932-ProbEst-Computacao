---
title: "Probabilidade e Estat√≠stica"
subtitle: "Infer√™ncia"
author: "Prof. Dr. Alessandro JQ Sarnaglia"
lang: "pt"
format:
  revealjs:
    width: 1280
    height: 720
    min-scale: 0.05
    fig-width: 5.5
    fig-height: 5.5
    theme: [custom.scss]
    css: [fonts.css, style.css]
    callout-icon: false
    toc: true
    toc-depth: 3
    toc-expand: 3
    number-sections: true
    number-depth: 3
    footer: "[T√≥picos üîô](../index.html) | [Sum√°rio üìã](inferencia.html#/TOC)"
    menu:
      useTextContentForMissingTitles: false
editor: source
filters:
  - parse-latex
---


# Distribui√ß√µes Amostrais

## Fun√ß√µes de Vari√°veis Aleat√≥rias

::: {.callout-caution}
## Observa√ß√£o

Muitas vezes √© de interesse determinar a distribui√ß√£o de uma fun√ß√£o de va's $X_1, \ldots, X_n$.
:::

::: {style="border-style: solid; border-width: 3px; padding-bottom: 0px; padding-right: 12px; padding-left: 12px; font-size:70%;"}

**Exemplo 1:** Um sistema de transa√ß√µes √© composto por dois componentes id√™nticos independentes. Quando o primeiro falha (com probabilidade $p$), √© imediatamente substituido pelo outro. Seja $X_i$ o n√∫mero de transa√ß√µes at√© a falha do componente $i$. Ent√£o $X_i\sim\text{Geo}(p)$. Qual a distribui√ß√£o de $Y = X_1 + X_2$?

::: 

::: {.callout-note}
## Defini√ß√£o - Caso discreto

Sejam $X_1, \ldots, X_n$ vad's com fmp conjunta $p(x_1, \ldots, x_n)$ e $Y = h(X_1, \ldots, X_n)$ uma fun√ß√£o dessas vari√°veis. A fmp de $Y$ √© dada por
<table>
  <tr style="border-bottom:none;text-align:center;">
    <td>$\displaystyle p_Y(y) = \underset{x_i\ :\ h(x_1,\ldots, x_n)\ =\ y}{\sum \cdots \sum} p(x_1, \ldots, x_n)$.</td>
  </tr>
</table>
:::

## 1.1 Fun√ß√µes de Vari√°veis Aleat√≥rias {.unnumbered .unlisted}

::: {style="border-style: solid; border-width: 3px; padding-top: 6px; padding-bottom: 0px; padding-right: 12px; padding-left: 12px; font-size:70%;"}

**Exemplo 1 (cont):** Note que $Y$ representa a quantidade de total de transa√ß√µes. Pela independ√™ncia de $X_1$ e $X_2$, temos que $p(x_1,x_2) = (1-p)^{x_1}p(1-p)^{x_2}p = (1-p)^{x_1+x_2}p^2$. Logo,
<table>
  <tr style="border-bottom:none;text-align:center;">
    <td>$p_Y(y)$ </td> <td> $=$ </td> <td> ${\displaystyle\underset{x_1,\ x_2\ :\ x_1\ +\ x_2\ =\ y}{\sum \sum} p(x_1, x_2) = \sum_{x_1 = 1}^{y-1} \sum_{x_2 = y-x_1}^{y-x_1} (1-p)^{x_1+x_2}p^2 = \sum_{x_1 = 1}^{y-1} (1-p)^{y}p^2}$</td>
  </tr>
  <tr style="border-bottom:none;text-align:center;">
    <td> </td> <td> $=$ </td> <td> ${\displaystyle (y-1)(1-p)^{x_1+x_2}p^2 = {y-1 \choose 1} (1-p)^{x_1+x_2}p^2}$.</td>
  </tr>
</table>
Portanto, $Y \sim \text{BN}(2,p)$.
:::

::: {.callout-caution}
## Observa√ß√£o

O Exemplo 1 pode ser generalizado. Mais precisamente, se $X_1, \ldots, X_k$ s√£o vad's independentes com $X_i \sim \text{Geo}(p)$ e $Y = \sum_{i=1}^k X_i$, ent√£o √© poss√≠vel mostrar que $Y \sim \text{BN}(k, p)$. Isto √©, soma de va's geom√©tricas independentes tem distribui√ß√£o binomial negativa.
:::

## 1.1 Fun√ß√µes de Vari√°veis Aleat√≥rias {.unnumbered .unlisted}

::: {style="border-style: solid; border-width: 3px; padding-top: 6px; padding-bottom: 0px; padding-right: 12px; padding-left: 12px; font-size:70%;"}

**Exemplo 2:** Uma pessoa chega no caixa em um tempo $X_1$ ap√≥s o instante 0 e uma segunda $X_2$ instantes ap√≥s a primeira. Se $X_1$ e $X_2$ s√£o independentes e $X_i \sim \text{Exp}(\lambda)$, qual √© distribui√ß√£o de $Y = X_1 + X_2$?

:::

::: {.callout-note}
## Defini√ß√£o - Caso cont√≠nuo

Sejam $X_1, \ldots, X_n$ vac's com fdp conjunta $f(x_1, \ldots, x_n)$ e $Y = h(X_1, \ldots, X_n)$ uma fun√ß√£o dessas vari√°veis. A fmp de $Y$ √© dada por $f_Y(y) = \frac{d}{dy}F_Y(y)$ em que $F_Y(y)$ √© a fda de $Y$ definida por
<table>
  <tr style="border-bottom:none;text-align:center;">
    <td>$\displaystyle F_Y(y) = P(Y \leq y) = P(h(X_1, \ldots, X_n) \leq y) = \underset{x_i\ :\ h(x_1,\ldots, x_n)\ \leq\ y}{\int \cdots \int} f(x_1, \ldots, x_n) dx_1 \cdots dx_n$.</td>
  </tr>
</table>
:::

::: {.callout-caution}
## Observa√ß√£o

Pela defini√ß√£o, n√£o obtemos diretamente $f_Y(y)$. Devemos obter $F_Y(y)$ e ent√£o calcular $f_Y(y) = \frac{d}{dy}F_Y(y)$.
:::

## 1.1 Fun√ß√µes de Vari√°veis Aleat√≥rias {.unnumbered .unlisted}

::: {style="border-style: solid; border-width: 3px; padding-top: 6px; padding-bottom: 0px; padding-right: 12px; padding-left: 12px; font-size:70%;"}

**Exemplo 2 (cont.):** Note que $Y$ o momento em que o segundo cliente chega √† loja. Pela independ√™ncia de $X_1$ e $X_2$, temos que $f(x_1,x_2) = \lambda e^{-\lambda x_1} \lambda e^{-\lambda x_2} = \lambda^2 e^{-\lambda (x_1 + x_2)}$. Logo,
<table>
  <tr style="border-bottom:none;text-align:center;">
    <td>$F_Y(y)$ </td> <td> $=$ </td> <td> ${\underset{x_1\ +\ x_2\ \leq\ y}{\int \int} f(x_1, x_2) dx_1 dx_2 = \int_{0}^{y} \int_{0}^{y-x_2} \lambda^2 e^{-\lambda (x_1 + x_2)} dx_1 dx_2 = \int_{0}^{y} \lambda e^{-\lambda x_2} [-e^{-\lambda x_1}|_{0}^{y-x_2}] dx_2}$</td>
  </tr>
  <tr style="border-bottom:none;text-align:center;">
    <td> </td> <td> $=$ </td> <td> ${ \int_{0}^{y} \lambda e^{-\lambda x_2} [1-e^{-\lambda (y-x_2)}] dx_2 = \int_{0}^{y} \lambda e^{-\lambda x_2} - \lambda e^{-\lambda y} dx_2 = [-e^{-\lambda x_2} - \lambda x_2 e^{-\lambda y}|_{0}^{y}]}$</td>
  </tr>
  <tr style="border-bottom:none;text-align:center;">
    <td> </td> <td> $=$ </td> <td> ${-e^{-\lambda y} - \lambda ye^{-\lambda y} + 1 - 0}$.</td>
  </tr>
</table>
Agora, derivando $F_Y(y)$, obtemos
<table>
  <tr style="border-bottom:none;text-align:center;">
    <td>$f_Y(y) = \frac{d}{dy}F_Y(y) = \frac{d}{dy}[-e^{-\lambda y} - \lambda ye^{-\lambda y} + 1] = \lambda e^{-\lambda y} - \lambda e^{-\lambda y} + \lambda^2 y e^{-\lambda y} = \frac{1}{(\frac{1}{\lambda})^2\Gamma(2)}y^{2-1}e^{-\frac{y}{\lambda^{-1}}}$. </td>
  </tr>
</table>
Portanto, $Y \sim \text{Gama}(2, \lambda^{-1})$.
:::

::: {.callout-caution}
## Observa√ß√£o

O Ex. 2 pode ser extendido. Se $X_1, \ldots, X_n$ s√£o vac's independentes com $X_i \sim \text{Exp}(\lambda)$ e $Y = \sum_{i=1}^n X_i$, ent√£o $Y \sim \text{Gama}(n, \lambda^{-1})$. Isto √©, soma de exponenciais independentes tem distribui√ß√£o gama.
:::

## Distribui√ß√£o Amostral

::: {.callout-caution}
## Observa√ß√µes

1. As defini√ß√µes anteriores nos permitem obter a distribui√ß√£o de fun√ß√µes de va's de maneira gen√©rica. Existem diversas ferramentas que podem facilitar essa tarefa: convolu√ß√£o, fun√ß√µes geradora de momentos e caracter√≠stica, m√©todo do jacobiano, entre outras. Elas n√£o ser√£o vistas aqui;
2. No contexto de infer√™ncia, dois conceitos importantes s√£o o de amostra aleat√≥ria e de estat√≠stica.
:::

::: {.callout-note}
## Defini√ß√£o - Amostra Aleat√≥ria

Seja $X$ va e $X_1, \ldots, X_n$ va's independentes com a mesma distribui√ß√£o que $X$. Dizemos que $X_1, \ldots, X_n$ √© uma **amostra aleat√≥ria** (aa) de $X$. Nesse caso, podemos dizer que $X$ descreve a vari√°vel na **popula√ß√£o**.
:::

::: {.callout-note}
## Defini√ß√£o - Estat√≠stica

Seja $X_1, \ldots, X_n$ aa de $X$. Uma estat√≠stica $T$ √© qualquer fun√ß√£o $T = T(X_1, \ldots, X_n)$ da referida amostra.
:::

## 1.2 Distribui√ß√£o Amostral {.unnumbered .unlisted}

::: {.callout-note}
## Defini√ß√£o - Distribui√ß√£o Amostral

Seja $X_1, \ldots, X_n$ aa de $X$ e $T = T(X_1, \ldots, X_n)$ uma estat√≠stica. Dizemos que a fda $F_T(t) = P(T \leq t) = P(T(X_1,\ldots, X_n) \leq t)$ √© a **distribui√ß√£o amostral** de $T$.
:::

::: {.callout-caution}
## Observa√ß√µes

1. O termo distribui√ß√£o amostral tamb√©m poder√° ser utilizado para nos referirmos a fmp $p_T(t)$ ou a fdp $f_T(t)$ da estat√≠stica $T$ se ela for discreta ou cont√≠nua, respectivamente;
2. As generaliza√ß√µes dos Exemplos 1 e 2 se tratavam de aa's das popula√ß√µes $X \sim \text{Geo}(p)$ e $X \sim \text{Exp}(\lambda)$, respectivamente. A estat√≠stica considerada nos dois exemplos era o **total amostral** $Y = \sum_i X_i$;
3. Por esses exemplos, fica claro que a distribui√ß√£o amostral de uma estat√≠stica depende da distribui√ß√£o da popula√ß√£o $X$: binomial negativa no Exemplo 1; e gama no Exemplo 2.
:::

## 1.2 Distribui√ß√£o Amostral {.unnumbered .unlisted}

::: {.callout-caution}
## Observa√ß√£o

Se a distribui√ß√£o populacional e/ou se a estat√≠stica for muito complicada, a obten√ß√£o anal√≠tica da distribui√ß√£o populacional pode ser muito dif√≠cil. Nesses casos, podemos utilizar m√©todos de **Monte Carlo** (t√©cnica computacional) para obter uma aproxima√ß√£o da distribui√ß√£o amostral da estat√≠stica de interesse.
:::

::: {style="border-style: solid; border-width: 3px; padding-top: 12px; padding-bottom: 0px; padding-right: 12px; padding-left: 12px; font-size:70%;"}

**Exemplo 3:** Seja $X_1, \ldots, X_n$ aa de $X \sim \text{Weibull}(10, 2)$, isto √© $\alpha=10$ e $\beta=2$. Considere a estat√≠stica
<table>
  <tr style="border-bottom:none;text-align:center;">
    <td>$\tilde{X} = T(X_1, \ldots, X_n) = \begin{cases} \frac{X_{(n/2)} + X_{(n/2+1)}}{2}, & n \text{ par}; \\ X_{(n+1)/2}, & n \text{ par}. \end{cases}$. </td>
  </tr>
</table>
Isto √©, $\tilde{X}$ √© a mediana amostral. Qual a distribui√ß√£o amostral de $\tilde{X}$ se $n=20$ e $n=40$? A estat√≠stica e a distribui√ß√£o populacional s√£o complexas para uma an√°lise anal√≠tica. Podemos usar m√©todos de Monte Carlo.
:::

## {.unnumbered .unlisted .smaller}

### Exemplo 3 (cont.) {.unnumbered .unlisted}

::: columns

::: {.column #vcenter width=65%}

```{.r code-line-numbers="|1-8|9-15|11-12|13-14|16-17|18-21|18-19|20-21|22-23"}
# par√¢metros da Weibull(a,b)
a <- 10; b<- 2
# Quantidade de r√©plicas
R <- 1000
# Tamanho da aa
n <- 20
# Vetor vazio para armazenar as medianas amostrais de cada r√©plica
med <- NULL
# Inicia as r√©plicas de Monte Carlo
for(r in 1:R){
  # Gera uma aa de tamanho n da Weibull(a, b)
  x <- rweibull(n=n, shape = a, scale = b)
  # Calcula a mediana amostral da amostra x
  med[r] <- median(x)                      
}
# Mediana populacional
med_pop <- b*(log(2))^(1/a)
# Histograma da distribui√ß√£o amostral da mediana amostral
hist(med)
# Tra√ßa a mediana da popula√ß√£o e intervalo +0.1 ou -0.1 desse valor
abline(v = med_pop + c(-.1,0,.1), col = 'red', lty = c(2,1,2), lwd = 2)
# Prop. das medianas amostrais entre med_pop - 0.1 e med_pop + 0.1
mean(med > med_pop-.1 & med < med_pop+.1)
```

:::

::: {.column #vcenter width=35%}

::: fragment

```{r}

a <- 10; b<- 2 # par√¢metros da Weibull(a,b)
R <- 1000      # Quantidade de r√©plicas
n <- 20        # Tamanho da aa
med <- NULL    # Vetor vazio para armazenar as medianas
               # amostrais de cada r√©plica
for(r in 1:R){ # Inicia as r√©plicas de Monte Carlo
  x <- rweibull(n=n, shape = a, scale = b) # Gera uma aa de tamanho n
                                           # da Weibull(a, b)
  med[r] <- median(x)                      # Calcula a mediana amostral
}
med_pop <- b*(log(2))^(1/a) # Mediana populacional
hist(med)                   # Histograma da distribui√ß√£o
                            # amostral da mediana amostral
abline(v = med_pop + c(-.1,0,.1),
       col = 'red', lty = c(2,1,2),
       lwd = 2) # Tra√ßa a mediana da popula√ß√£o e intervalo
                # +0.1 ou -0.1 desse valor
prp <- mean(med > med_pop-.1 & med < med_pop+.1)
cat("P[Med. Amost. \u2208 (Med. Pop. \u00b1 0.1)] \u2248 ", prp, sep='') 
```

:::

:::

:::

## {.unnumbered .unlisted .smaller}

### Exemplo 3 (cont.) {.unnumbered .unlisted}

::: columns

::: {.column #vcenter width=65%}

```{.r code-line-numbers="|5-6"}
# par√¢metros da Weibull(a,b)
a <- 10; b<- 2
# Quantidade de r√©plicas
R <- 1000
# Tamanho da aa
n <- 40
# Vetor vazio para armazenar as medianas amostrais de cada r√©plica
med <- NULL
# Inicia as r√©plicas de Monte Carlo
for(r in 1:R){
  # Gera uma aa de tamanho n da Weibull(a, b)
  x <- rweibull(n=n, shape = a, scale = b)
  # Calcula a mediana amostral da amostra x
  med[r] <- median(x)                      
}
# Mediana populacional
med_pop <- b*(log(2))^(1/a)
# Histograma da distribui√ß√£o amostral da mediana amostral
hist(med)
# Tra√ßa a mediana da popula√ß√£o e intervalo +0.1 ou -0.1 desse valor
abline(v = med_pop + c(-.1,0,.1), col = 'red', lty = c(2,1,2), lwd = 2)
# Prop. das medianas amostrais entre med_pop - 0.1 e med_pop + 0.1
mean(med > med_pop-.1 & med < med_pop+.1)
```

:::

::: {.column #vcenter width=35%}

::: fragment

```{r}

a <- 10; b<- 2 # par√¢metros da Weibull(a,b)
R <- 1000      # Quantidade de r√©plicas
n <- 40        # Tamanho da aa
med <- NULL    # Vetor vazio para armazenar as medianas
               # amostrais de cada r√©plica
for(r in 1:R){ # Inicia as r√©plicas de Monte Carlo
  x <- rweibull(n=n, shape = a, scale = b) # Gera uma aa de tamanho n
                                           # da Weibull(a, b)
  med[r] <- median(x)                      # Calcula a mediana amostral
}
med_pop <- b*(log(2))^(1/a) # Mediana populacional
hist(med)                   # Histograma da distribui√ß√£o
                            # amostral da mediana amostral
abline(v = med_pop + c(-.1,0,.1),
       col = 'red', lty = c(2,1,2),
       lwd = 2) # Tra√ßa a mediana da popula√ß√£o e intervalo
                # +0.1 ou -0.1 desse valor
prp <- mean(med > med_pop-.1 & med < med_pop+.1)
cat("P[Med. Amost. \u2208 (Med. Pop. \u00b1 0.1)] \u2248 ", prp, sep='') 
```

:::

:::

:::

## Distribui√ß√£o Amostral da M√©dia Amostral

::: {.callout-caution}
## Observa√ß√£o

Embora a distribui√ß√£o amostral dependa da distribui√ß√£o da popula√ß√£o, no caso da estat√≠stica **m√©dia amostral**, $\bar{X} = \frac{1}{n}\sum_{i=1}^n X_i$, o Teorema Central do Limite nos fornece a sua [**distribui√ß√£o amostral limite**]{style='color:red;'}, independente da distribui√ß√£o populacional.
:::

::: {.callout-warning}
## Propriedade - Teorema Central do Limite (TCL)

Seja $X_1, \ldots, X_n$ aa de $X$, onde $E(X) = \mu$ e $V(X) = \sigma^2 < \infty$. Ent√£o a estat√≠stica
<table>
  <tr style="border-bottom:none;text-align:center;">
    <td>${\displaystyle Z_n = \frac{\bar{X} - \mu}{\sigma/\sqrt{n}}}$ </td>
  </tr>
</table>
tem distribui√ß√£o aproximadamente normal padr√£o. A aproxima√ß√£o fica melhor com o aumento de $n$.
:::

## 1.3 Distribui√ß√£o Amostral da M√©dia Amostral {.unnumbered .unlisted}


::: {.callout-caution}
## Observa√ß√µes

1. A m√©dia amostral tem distribui√ß√£o aproximadamente $\text{N}(\mu, \frac{\sigma^2}{n})$, em que $\mu$ e $\sigma^2$ s√£o a m√©dia e a vari√¢ncia da popula√ß√£o $X$ da qual a amostra ser√° observada;
2. A aproxima√ß√£o se torna melhor com o aumento do tamanho amostral $n$;
3. O valor de $n$ necess√°rio para que a aproxima√ß√£o seja ''boa'' depende da distribui√ß√£o da popula√ß√£o;
4. Por exemplo, dados provenientes de popula√ß√µes assim√©tricas exigem o valor de $n$ maior.
:::

::: {.callout-warning}
## Propriedades - Corol√°rio do TCL

Seja $X_1, \ldots, X_n$ aa de $X$, onde $E(X) = \mu$ e $V(X) = \sigma^2 < \infty$ e $S_n = \sum_{i=1}^n X_i$ o total amostral. Ent√£o
<table>
  <tr style="border-bottom:none;text-align:center;">
    <td>${\displaystyle Z_n = \frac{S_n - n\mu}{\sigma\sqrt{n}}}$ </td>
  </tr>
</table>
tem distribui√ß√£o aproximadamente normal padr√£o.
:::

## 1.3 Distribui√ß√£o Amostral da M√©dia Amostral {.unnumbered .unlisted}

::: {style="border-style: solid; border-width: 3px; padding-top: 12px; padding-bottom: 0px; padding-right: 12px; padding-left: 12px; font-size:70%;"}

**Exemplo 2 (cont.):** Tinhamos uma aa de uma popula√ß√£o $X \sim \text{Exp}(\lambda)$. Note que $\mu = E(X) = \frac{1}{\lambda}$ e $\mu = V(X) = \frac{1}{\lambda^2}$. Vimos que a distribui√ß√£o exata do total amostral era uma $\text{Gama}(n, \frac{1}{\lambda})$.

Suponha que temos $\lambda = 0.5$ e desejamos encontrar $P(\bar{X} \leq \mu - 0.5) = P(S_n \leq n\mu - 0.5n)$, cujo valor exato pela gama √© `r round(pgamma(20*(2-0.5), shape = 20, scale=2), 4)`, se $n=20$ e `r round(pgamma(40*(2-0.5), shape = 40, scale=2), 4)`, se $n=40$, por exemplo.

Agora, temos que
<table>
  <tr style="border-bottom:none;text-align:center;">
    <td>$P(S_n \leq n\mu - 0.5n)$ </td> <td>$=$ </td> <td> $P(\frac{\bar{X} - \mu}{\sigma/\sqrt{n}} \leq \frac{\mu - 0.5 - \mu}{\sigma/\sqrt{n}}) = P(Z_n \leq -\frac{\lambda\sqrt{n}}{2})$ </td>
  </tr>
  <tr style="border-bottom:none;text-align:center;">
    <td> </td> <td>$\approx$ </td> <td> ${\displaystyle \begin{cases} P(Z \leq -1.12) = 0.1314, & n=20;\\ P(Z \leq -1.58) = 0.0571, & n=40. \end{cases}}$ </td>
  </tr>
</table>

:::

::: {.callout-caution}
## Observa√ß√£o

Note que, considerando a assimetria da popula√ß√£o ($X\sim\text{Exp}(0.5)$), as probabilidades exatas e a aproximadas s√£o relativamente pr√≥ximas, mesmo para valores de $n$ moderados.
:::

# Estima√ß√£o Pontual

# Estima√ß√£o Intervalar

# Testes de Hip√≥teses

# FIM {.unnumbered .unlisted}

# APAGAR DPS 1 {.unnumbered .unlisted}

::: {.callout-caution}
## Observa√ß√£o

:::

::: {.callout-note}
## Defini√ß√£o

:::

::: {.callout-warning}
## Propriedade

:::

::: {.callout-tip}
## Exerc√≠cios

:::

::: {.callout-important}
## Problema

:::


::: {style="border-style: solid; border-width: 3px; padding-bottom: 0px; padding-right: 12px; padding-left: 12px; font-size:70%;"}

**Exemplo:** 

::: 

# APAGAR DPS 2 {.unnumbered .unlisted}

::: columns

::: {.column #vcenter width=45%}
1
:::

::: {.column #vcenter width=55%}
2

3

4
:::

:::



```{=latex}
\begin{align*}
\Omega &= \{(1,1), (1,2), \ldots, (4,4)\}\\
       &= \{(x,y) : x,y = 1,\ldots,4\}.
\end{align*}
```


# FIM {.unnumbered .unlisted}
